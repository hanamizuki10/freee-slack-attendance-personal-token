# freee勤怠Slack個人通知

freeeの出勤・退勤・休憩開始・休憩終了ボタンをクリックすると、自動的にSlackに通知を送信するChrome拡張機能です。
本バージョンは「Slackユーザートークン＋チャンネルID」を使い、個人アカウント名義で好きなチャンネルに投稿できます。

## 機能

- freeeの出勤・退勤・休憩開始・休憩終了ボタンのクリックを検知
- 自動的にSlackに通知を送信（出勤、退勤、休憩開始、休憩終了）
- 設定画面でSlackユーザートークン・チャンネルID・通知メッセージを自由にカスタマイズ
- メッセージは日本語で自由に編集可能
- 個人ごとに好きなチャンネル・自分の名義で投稿可能

## インストール方法

1. このリポジトリをダウンロードまたはクローンします
   ```
   git clone https://github.com/yourusername/freee-slack-attendance-personal-token.git
   ```
   または「Download ZIP」からダウンロード＆解凍

2. Chromeブラウザを開きます

3. 拡張機能の管理ページを開きます
   - アドレスバーに `chrome://extensions` と入力
   - または Chromeメニュー →「その他のツール」→「拡張機能」

4. 右上の「開発者モード」をオンにします

5. 「パッケージ化されていない拡張機能を読み込む」ボタンをクリック

6. ダウンロードしたプロジェクトのディレクトリを選択

7. 拡張機能がインストールされると、Chrome右上にアイコンが表示されます

## Slackユーザートークン・チャンネルIDの取得方法

### 1. Slackユーザートークンの取得

#### A. アプリの新規作成（初回のみ）

1. [Slack API: Your Apps](https://api.slack.com/apps) にアクセス
2. 「Create New App」ボタンをクリック
   - 「From scratch」を選択
   - アプリ名（例：「freee勤怠通知」）を入力
   - Short description（例）：「freeeの勤怠打刻をSlackに自動通知する拡張機能です」
   - 使用するSlackワークスペースを選択し、「Create App」をクリック

#### B. ユーザートークンの取得（全員共通）

1. 既存アプリを選択（または上記Aで作成したアプリを選択）
2. 左メニュー「OAuth & Permissions」を選択
3. 「User Token Scopes」に `chat:write` を追加
4. ページ上部「Install App to Workspace」ボタンからワークスペースにインストール
5. インストール後「User OAuth Token（xoxp-で始まる文字列）」が表示されるのでコピー

> ※ Slackアプリは1つだけ用意し、全員が同じアプリを使って自分のユーザートークンを取得する運用が推奨です。

### 2. チャンネルIDの取得

- 投稿したいチャンネルをSlackで開き、URL末尾の「Cxxxxxx」部分がチャンネルIDです。
- 例: `https://app.slack.com/client/T00000000/C12345678` → `C12345678`
- `#チャンネル名` でも動作しますが、ID指定が確実です。

## 拡張機能の設定方法

1. Chrome右上の拡張機能アイコンをクリック
2. 「freee勤怠Slack個人通知」の設定画面を開く
3. 「Slackユーザートークン」「チャンネルIDまたは#チャンネル名」を入力
4. 必要に応じてカスタムメッセージも編集
5. 「保存」ボタンをクリック
   - 「設定を保存しました」と表示されればOK

> **補足**: 設定情報はChrome拡張のストレージにのみ保存され、外部に送信されることはありません。

## 使用方法

1. freeeの勤怠管理ページ（https://*.freee.co.jp/*）にアクセス
2. 「出勤」「退勤」「休憩開始」「休憩終了」ボタンをクリック
3. Slackで指定したチャンネルに自分の名義で通知が送信されます
   - 出勤ボタン → 「勤務開始します」（カスタム可）
   - 退勤ボタン → 「退勤します」（カスタム可）
   - 休憩開始ボタン → 「休憩します」（カスタム可）
   - 休憩終了ボタン → 「再開します」（カスタム可）

## 注意事項・セキュリティ

- ユーザートークンは個人のSlack権限で動作します。絶対に他人と共有しないでください。
- トークンはローカル（chrome.storage.local）にのみ安全に保存されます。リポジトリやコードには一切残りません。
- ワークスペースの管理者が「ユーザーによるアプリのインストール」を許可している必要があります。
- トークンの権限は必要最小限（`chat:write`）にしてください。

## よくある質問

- **Q. 他の社員も使えますか？**
  - A. はい。全員が同じアプリで自分のユーザートークンを取得し、設定画面で入力してください。
- **Q. チャンネルごとに投稿先を変えられますか？**
  - A. はい。各自が好きなチャンネルIDや#チャンネル名を設定できます。
- **Q. Webhook版との違いは？**
  - A. WebhookはBot名義固定ですが、個人トークン版は自分のSlackアカウント名義で投稿できます。

- **Q. CORSエラーは発生しませんか？**
  - A. Slack APIへのリクエストはbackground.jsで実行されるため、CORSエラーは発生しません。

- **Q. デバッグログはどこで見られますか？**
  - A. 通常運用時は不要なconsole.logはコメントアウトされています。必要な場合は該当箇所のコメントを外してください。

---

ご不明点・要望があればIssueまたは管理者までご連絡ください。

2. 通常通り出勤・退勤・休憩開始・休憩終了ボタンをクリックします

3. ボタンをクリックすると自動的にSlackの設定したチャンネルに通知が送信されます
   - 出勤ボタン → 「勤務開始します」（※このメッセージは自由に変更できます）
   - 退勤ボタン → 「退勤します」（※このメッセージは自由に変更できます）
   - 休憩開始ボタン → 「休憩します」（※このメッセージは自由に変更できます）
   - 休憩終了ボタン → 「再開します」（※このメッセージは自由に変更できます）

> 通知メッセージは設定画面で各ボタンごとにカスタマイズ可能です。

## トラブルシューティング

- **通知が送信されない場合**
  - Webhook URLが正しく設定されているか確認してください
  - ブラウザのコンソールでエラーメッセージを確認してください（F12キーを押してDeveloper Toolsを開き、「Console」タブを選択）
  - インターネット接続が正常か確認してください

- **拡張機能が動作しない場合**
  - 拡張機能が有効になっているか確認してください
  - freeeのURLが正しいか確認してください（https://*.freee.co.jp/*）
  - ページを再読み込みしてみてください

## 注意事項

- この拡張機能はfreeeのページ（https://*.freee.co.jp/*）でのみ動作します
- SlackのWebhook URLは事前に設定する必要があります
- 通知の送信にはインターネット接続が必要です
- Webhook URLは他人に教えないでください（第三者がメッセージを送信できる可能性があります）

## ライセンス

MIT License
